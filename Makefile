BUILD_DIR = ./bin
WEB_DIR = ./web/build/
TIRELEASE_BINARY = ${BUILD_DIR}/tirelease
DOCKER_NAME = tirelease

all: build.web build.server

run: all
	./${TIRELEASE_BINARY}

clean:
	rm -rf ${WEB_DIR}
	rm -rf ${BUILD_DIR}

docker:
	docker build -t ${DOCKER_NAME} .

build.web:
	cd web && \
	yarn install && \
	yarn build

build.server:
	go build -o ${TIRELEASE_BINARY} cmd/tirelease/*.go

help:
	@echo "make all : build all binaries for tirelease"
	@echo "make run : build all binaries for tirelease and run"
	@echo "make clean : clear all temporary files and folders generated by the 'make all' or 'make run'"

.PHONY: docker
.PHONY: build.web build.server all run clean help

